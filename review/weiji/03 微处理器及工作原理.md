## 第三章 微处理器及工作原理
---

- X86 英特尔，AMD 性能高，速度快，兼容性好
- ARM 苹果谷歌华为 成本低功耗低
- MIPS 龙芯 简洁，优化方便，高扩展性
- RISC-V 三星，英伟达，西数 模块化，极简，可扩展

####  1.微处理器发展历史
*  英特尔创立与发展
* 摩尔定律：当价格不变时，集成电路上可容纳的晶体管数目，约每隔18个月便会增加一倍，性能也将提升一倍。
* Intel微处理器的发展 4位处理器->8位处理器 ->16->32->64
* CPU的制作过程

#### 2.微处理器的性能指标
* 字长：CPU在单位时间内（同一时间）能一次处理的二进制数的位数叫字长
* 指令集：是计算机体系结构中与程序设计有关的部分，包含了*数据类型，指令集，寄存器，寻址模式，存储体系，中断，异常处理以及外部IO*，可分为复杂指令集CISC和精简指令集RISC。
* 指令执行周期：执行一条指令所需要的时间，一般由若干个机器周期组成，是从取指令、分析指令到执行完所需的全部时间。
* 访存空间：CPU可以访问存储空间的大小
* 并行处理能力
* 体积/功耗/工作温湿度

#### 3.微处理器工作原理
##### 8086架构及工作原理
- 微处理器8088  协处理器8087
- 8253定时/计数器
- 8259中断控制器
- 8250串行通信控制器
- 8255并行接口
- DMA控制器  主板上的RAM
- DMA页面寄存器
- ROM BIOS 
- 扩展总线缓冲 PC总线 8个8位62引脚扩展插槽

###### (1) 8086内部结构
[![LQ60Z6.png](https://s1.ax1x.com/2022/04/14/LQ60Z6.png)

* 总线接口单元(BIU)
	* 4个16位段寄存器 CS(code segment) DS(data segment) SS(stack segment) ES(extra segment) 存放每种段的段首地址
	* 16位指令指针寄存器IP(Instruction Pointer) 保存着EU要执行的下一条指令的偏移地址EA(effect address)。
	* 指令队列 6个8位寄存器，用来暂存指令的单元，采用先进先出的原则，顺序被取到EU中执行
	* 20位地址加法器 段首地址和偏移地址统称为逻辑地址，是16位的。实际地址(physical address) PA = (段首地址 * 16) + 偏移地址，是20位的
* 指令执行单元(EU)
	* 通用寄存器8个16位寄存器，其中4个数据寄存器:AX BX CX DX，4个专用寄存器:堆栈指针寄存器SP(stack pointer)，基址指针寄存器BP(base pointer)，目的变址寄存器DI(destination index)存放目的操作数地址偏移量，源变址寄存器SI(source index)存放源操作数地址偏移量。
	* 16位算术逻辑单元ALU
	* 16位状态标志寄存器Flag：反映ALU运算结果的特征状态，存放控制标志
	* 暂存寄存器：对参加运算的数据进行暂存
- 执行过程
	- 从指令队列取出指令
	- 对指令进行译码，发出相应的控制信号
	- 接收由总线接口送来的数据或发送数据至接口
	- 进行算数运算

![标志寄存器](https://s1.ax1x.com/2022/06/15/XIzzwD.png)

###### (2)8086外部管脚
* 8086采用三总线体系结构，CPU采用40条引脚的双列直插DIP封装，数据总线16条，地址总线20条
	* 地址/数据总线 AD15-AD0 地址/数据复用引脚 16条
	* 地址/状态总线 A19/S6-A16/S3 4条
	* 控制总线 17条
	* 电源线 3 条

###### (3)8086的寻址方式
* 8086存储映射方式 AD0-AD7传送偶地址单元的数据，AD8-AD15传送奇地址单元的数据，每个字节用一个唯一的地址码表示，这称为存储器的标准结构。存放时，其低位字节可从奇数 地址开始，这种方式称为非规则方式，奇数地址的字称为非规则字。其高位字节可从偶数地址开始， 这种方式称为规则方式，将偶数地址的字称为规则字。
* 8086存储器分段结构：物理地址20位，规定了1M字节存储体中某个具体单元的地址。逻辑地址16位即段首地址：偏移地址，最大寻址空间1MB，最大分段64KB。8086CPU把1M字节的存储器空间划分为任意的一些存储段，一个存储段是存储器中可独立寻址 的一个逻辑单位，也称逻辑段，每个段的长度为64K字节。
* 寻址方式
	* 实地址模式：所有段都是可读可写可执行
	* 保护模式：提供了段间保护机制，同时内存空间变大
* 总线时序：即CPU通过总线进行操作（读/写、释放总线、中断响应）时，总线上各信号之间在时间顺序上的配合关系：I/O读写周期，存储器读写操作，中断响应操作，总线保持周期，复位周期。

![XoANWD.png](https://s1.ax1x.com/2022/06/15/XoANWD.png)

##### core体系结构 
详见ppt
- LGA：(Land Grid Aarray)是INTEL64位平台的封装方式，触点阵列封装。
- BGA：(Ball Grid Array）即球栅阵列封装技术。
- PGA：(Pin Grid Array）即插针网格阵列封装技术。
- Thunderbold技术
- Optane技术
- 互联环结构
- 图形处理器多执行单元结构
- CPU 微结构
- 动态电源管理技术

GPU- 图形处理器：又称显示核心、视觉处理器、显示芯片，是一种专门在个人电脑、工作站、游戏机和一些移动设备 （如平板电脑、智能手机等）上图像运算工作的微处理器。用途是将计算机系统所需要的显示信息进行转 换驱动，并向显示器提供行扫描信号，控制显示器的正确显示。

80x86的保护工作模式：新增四个寄存器 (指针 ----- 指向内存中的特殊的数据表)：
- 全局描述符表寄存器 GDTR（Globe Descriptive Table Register) 
- 局部描述符表寄存器 LDTR ( Local Descriptive Table Register) 
- 中断描述符表寄存器 IDTR ( Interrupt Descriptive Table Register) 
-  任务寄存器 TR (Task Register)


#### 4.新型微处理器技术进展
* 超标量与超流水线结构
* 超线程技术
* 多核技术
* 缓存技术
* 指令集架构
* 64位体系结构
	* X86不足：可变的指令长度，寄存器的贫乏，内存访问，浮点堆栈，芯片变大
* 3D-IC技术